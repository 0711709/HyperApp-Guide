# FAQ

----

## HyperApp 常见问题

#### **关于国区被下架的问题**

1. 「换区」临时的下载&更新方案是将自己账号换区，比如加拿大区（不需要绑定支付方式），然后点击购买即可（不需要再次付费）。
2. 「TestFlight」在国区购买的用户可以将「Apple 提供的收据」（必需）和邮箱发给我加入 TF，不换区也能一直保持更新。邮件发送至 HyperAppCloud🌀gmail.com
3. iMazing 免费版就可以安装已下架的应用，是目前最简单的办法，搜索即可。


#### **如何申请 TF**

在 `App` 里面点击 `发送反馈邮件` 将主题改为 `申请 TF` 并且附上购买收据即可。


#### **如何升级应用？**

1. 在服务器下面的 Docker 监控里选择你的应用，轻点后选择 `Pull Image` 即可更新镜像，然后在应用那里 `更新配置`
2. 手动的话可以 `docker ps` 找到应用的镜像名字，然后 `docker pull 镜像`，然后在应用那里 `更新配置`

----

## 代理连接失败的基本排查

#### 排查服务端的问题

1. HyperApp 里面刷新一下服务器状态，看应用是否启动成功(显示 up xxx seconds/minutes/hours)
2. 点击 `查看日志` 看看应用日志中是否有错误提示
  
   - ss-libev 如果有一些连接错误的信心，一般是客户端的密码、加密方式、混淆没填对。
3. 如果上两步都没有问题，请检查
   - 是否是机器防火墙问题（参考下面的第二项）
   
   - 是否是客户端配置错误（参考下面的客户端排错）
   
#### 如何排查服务器是否有防火墙阻拦了某个端口？

1. 在 VPS 上运行: `telnet localhost PORT(要检查的端口)` 能通说明服务端没问题。不通说明服务端启动失败。
2. 在电脑上运行`telnet IP PORT(要检查的端口)` 能通说明防火墙没问题。不通说明是防火墙的问题。
3. 在 VPS 上运行 `lsof -i :端口` 来查看是否有进程正在监听该端口，如果有说明是防火墙屏蔽了端口访问，如果没有说明部署失败。

#### 排查客户端的问题

- 是否使用了跟服务端一致的配置。建议通过扫描二维码的方式添加。

- 如果你用 Wingy 不要开 OBFS （除非你自己足够了解）

- 另外不要用 SSR 连 SS，也不要用 SS 连 SSR

- ss-libev 客户端的 http/tls 混淆必须要和服务端一致。（服务器如果设置的 tls 混淆，客户端也必须用 tls）

- 最后如果你的问题不在上述思路中.请仔细查看文章中涵盖的hyperapp常见问题以及解决方案.实在搞不懂再上群提问并且请注意你的语气.没有人有义务帮助你.

#### 手机可以电脑不行

* 请先查看客户端日志，并贴出来用全局模式测非Chrome、Firefox浏览器（因为Chrome浏览器的很多插件会改代理设置）如果全局可以就能断定是pac规则或者浏览器的原因。

----


## 网页无法访问的基本排查

#### 常见原因

1. 如果你启用了 `HTTPS` 请稍等片刻，SSL Support 获取证书需要时间（大约几分钟）。
2. 有些应用安装后也需要几分钟的初始化时间（比如数据库初始化），请稍等几分钟再试。

#### 如果错误继续，参考下面过程排错

1. 刷新服务器状态，确保应用处于 `running` 状态。
2. 如果不在运行中的状态，说明安装后的初始化没有成功，查看应用日志可以看到出错原因。
3. 如果你要寻求帮助，请发出此处的日志截图，且要贴全。

----

## 防火墙设置教程

#### 临时禁用系统防火墙

  - CentOS7: service firewalld stop
  - CentOS6: service iptables stop
  - Ubuntu16: service ufw stop

#### 永久禁用系统防火墙

  - CentOS7: systemctl disable firewalld
  - Ubuntu16: systemctl disable ufw

#### 系统防火墙永久添加端口

  - CentOS7: firewall-cmd --permanent --zone=public --add-port=端口/tcp

#### 平台防火墙

  - GCE: 网络 → 防火墙规则
    - 点击`创建防火墙规则`
      - 名称：随便输入一个名称
      - 目标：选择 `网络中的所有示例`
      - 来源过滤：`0.0.0.0/0`
      - 协议和端口：`指定的协议和端口` 下面输入 `tcp;udp:端口号`
  - AWS: EC2 控制面板 → 安全组
  - 阿里云: 云服务器 ECS → 安全组

----

## 系统问题

#### 如何手动开启 BBR

* 注意以下命令需要 `root` 权限，非 root 用户先执行 `sudo su -` 切换到 root 账户

1. 运行 `uname -r` 看看是不是内核 >= 4.9，不是的话请先升级内核

2. 执行 `lsmod | grep bbr`，查看 BBR 模块是否启用，如果结果中没有 tcp_bbr 的话就先执行

   ```sh
   modprobe tcp_bbr
   echo "tcp_bbr" >> /etc/modules-load.d/modules.conf
   ```

3. 执行命令设置 TCP 使用 BBR 发包

   ```sh
   echo "net.core.default_qdisc=fq" >> /etc/sysctl.conf
   echo "net.ipv4.tcp_congestion_control=bbr" >> /etc/sysctl.conf
   ```

4. 执行以下命令保存以上设置生效启用 

   ```sh
   sysctl -p
   ```

#### 验证 BBR 是否已经启用

```sh
sysctl net.ipv4.tcp_available_congestion_control
sysctl net.ipv4.tcp_congestion_control
```

* 如果输出结果都有bbr, 则证明你的内核已开启bbr

----

## 厂商常见问题：

#### 二维码显示不全，如何手动添加 GCP ？

1. 二维码上面有 `IP`，`用户名`，`端口` 信息，在 `HyperApp → 服务器` 中点击添加按钮，选择手动配置。
2. 在出现的窗口中，分别输入上面对应的字段，密码不填写，在最下面的密钥那里选择一个密钥（应该只有一个）。
3. 添加即可。但是稍后的可能会出现密钥认证失败的错误，所以建议将密钥名字改成你的 gmail 邮箱名字。或者按照教程，修改两处用户名一致即可。

#### 其他厂商常见问题

* 搬瓦工只支持 KVM虚拟化 的机器。

* Vultr/DigitalOcean/AWS 全都支持

* GCP没有领到试用金：重新打开试用页面再点击一次“Try it free”

* 50Kvm 的机器第一次登录需要记下下次登录的 SSH 端口

* DigitalOcean 的机器第一次登录需要改密码

----

## 安装错误

* 如果你遇到以下情况请查看[关于安装错误的FAQ](FAQ-Error.md)

  * 初始化服务器的时候遇到问题
  * 安装应用的过程中报错或者出现预料以外的提示
----

## 应用问题

* 如果你遇到以下情况请查看[关于应用问题的FAQ](FAQ-App.md)

  * 在商店安装的应用遇到问题
  * 应用的使用过程中遇到限制或者其他问题

----


